<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="theme-color" content="#f6f8fc" />


  <meta property="og:image" content="https://siddroid.com//images/composition.gif" />
 
  <meta name="generator" content="Hugo 0.92.1" />

  <title>Build function chains using composition in Kotlin &middot; Sid Patil</title>

  <meta name="description" content="Leverage Kotlin fold aggregating operators to build function chains with compositional patterns. Learn how you can build a system similar to compose UIs Modifier logic on Android" />

  
  <meta property="og:locale" content="en-us"/>

  <meta property="og:image" content="https://siddroid.com//images/composition.gif" />

  
  <meta property="og:site_name" content="Sid Patil - Android Engineer and Kotlin Advocate"/>
  <meta property="og:title" content="Build function chains using composition in Kotlin"/>
  <meta property="og:description" content="Leverage Kotlin fold aggregating operators to build function chains with compositional patterns. Learn how you can build a system similar to compose UIs Modifier logic on Android"/>
  <meta property="og:url" content="https://siddroid.com/post/kotlin/build-function-chains-using-composition-in-kotlin/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2021-08-24T12:06:12&#43;0530"/>
  <meta property="article:modified_time" content="2022-05-24T23:11:30"/>
  <meta property="article:author" content="Sid Patil">
  
  
  <meta name="thumbnail" content="https://siddroid.com//images/composition.gif">
  <meta name="twitter:image" content="https://siddroid.com//images/composition.gif">
  <meta name="twitter:card" content="summary_large_image">
  

  
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "TechArticle",
    "name": "Build function chains using composition in Kotlin",
    "headline": "Build function chains using composition in Kotlin",
    "alternativeHeadline": "Learn Kotlin and Android development with Sid Patil",
    "editor": "Sid Patil",
    "genre": "Android development and Kotlin programming",
    "publisher": {
      "@type": "Organization",
      "name": "Siddroid",
      "url": "https://siddroid.com/",
      "logo": {
        "@type": "ImageObject",
        "url": "https://siddroid.com/images/siddhesh_patil.jpg"
      },
      "sameAs" : [ "https://www.linkedin.com/in/patilsid/",
        "https://www.github.com/patilsiddhesh/",
        "https://facebook.com/siddroid/",
        "https://patilsiddhesh.medium.com/",
        "http://twitter.com/siddroid"]
    },
     
    "datePublished": "2021-08-24T12:06:12",
    
    "dateModified": "2022-05-24T23:11:30",
    "author": {
      "@type" : "Person",
      "name": "Siddhesh Patil",
      "alternateName" : "Sid Patil",
      "@id": "https://siddroid.com/about",
      "image": "https://siddroid.com/images/siddhesh_patil.jpg",
      "alumniOf": [
      {
       "@type": "CollegeOrUniversity",
       "name": "University of Mumbai",
       "sameAs": "https://en.wikipedia.org/wiki/University_of_Mumbai"
      },
      {
        "@type": "CollegeOrUniversity",
        "name": "Atharva College of Engineering",
        "sameAs": "http://www.atharvacoe.ac.in/"
       },
      {
       "@type": "CollegeOrUniversity",
       "name": "Bhavans College",
       "sameAs": "https://en.wikipedia.org/wiki/Bhavan's_College"
      }
    ],
      "nationality": "Indian",
      "gender": "male",
      "sameAs" : [ "https://www.linkedin.com/in/patilsid/",
        "https://facebook.com/siddroid/",
        "https://www.github.com/patilsiddhesh/",
        "https://patilsiddhesh.medium.com/",
        "http://twitter.com/siddroid"],
        "birthPlace": {
          "@type": "Place",
          "address": {
            "@type": "PostalAddress",
            "addressLocality": "Mumbai",
            "addressRegion": "Maharashtra"
          }
        },
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Berlin",
        "addressRegion": "Germany"
      },
      "affiliation": [
	    {
		  "@type": "Organization",
		  "name": "Paytm",
		  "sameAs": [
			"https://twitter.com/paytm",
			"https://paytm.com"
		  ]
  	},
    {
		  "@type": "Organization",
		  "name": "Delivery Hero",
		  "sameAs": [
			"https://twitter.com/deliveryherocom",
			"https://www.deliveryhero.com"
		  ]
  	},
    {
		  "@type": "Organization",
		  "name": "Paytm Insider",
		  "sameAs": [
			"https://twitter.com/paytminsider",
			"https://insider.in"
		  ]
  	},
    {
		  "@type": "Organization",
		  "name": "Kotlin Mumbai",
		  "sameAs": [
			"https://twitter.com/kotlinmumbai",
			"https://kotlinmumbai.tech"
		  ]
  	}

],
      "jobTitle": "Android Engineer",
      "worksFor": [
      {
      "@type": "Organization",
      "name": "Delivery Hero",
      "sameAs": [
        "https://twitter.com/deliveryherocom",
        "https://deliveryhero.com"
      ]
      },
          {
      "@type": "Organization",
      "name": "Paytm",
      "sameAs": [
        "https://twitter.com/paytm",
        "https://paytm.com"
      ]
      }
    ],
      "url" : "https://siddroid.com",
      "disambiguatingDescription": "Android Engineer at Paytm Insider and Organizer of Kotlin Mumbai",
      "description": "Android Engineer and Kotlin Advocate from Berlin, Germany. Learn to develop quality Android apps and build software with Kotlin."
    
    },
    
    "image": "https://siddroid.com//images/composition.gif",
    "url": "https://siddroid.com/post/kotlin/build-function-chains-using-composition-in-kotlin/",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://siddroid.com/"
    },
     
    "keywords": ["Kotlin","Kotlin Functions","Functional chaining","Compositional patterns","Inheritance vs composition","Kotlin fold and reduce functions","Higher order logic kotlin","Kotlin articles by Sid Patil"],
    
    "description": "Leverage Kotlin fold aggregating operators to build function chains with compositional patterns. Learn how you can build a system similar to compose UIs Modifier logic on Android",
    "articleBody": "Leverage Kotlin fold aggregating operators to build function chains with compositional patterns. Learn how you can build a system similar to compose UIs Modifier logic on Android"
  }
  </script>
  


  <link type="text/css"
        rel="stylesheet"
        href="https://siddroid.com/css/print.css?v=848"
        media="print">

  <link type="text/css"
        rel="stylesheet"
        href="https://siddroid.com/css/poole.css?v=148">

  <link type="text/css"
        rel="stylesheet"
        href="https://siddroid.com/css/hyde.css?v=940">
  
  <link href="https://fonts.googleapis.com/css2?family=Material+Icons+Outlined"
        rel="stylesheet">


  


  <link rel="preload" as="font" href="/fonts/Gilroy-SemiBold.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/Gilroy.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/fonts/Roboto-Regular.woff2" type="font/woff2" crossorigin="anonymous">

  


        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://siddroid.com//favicon/apple-touch-icon-57x57.png?v=845" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://siddroid.com//favicon/apple-touch-icon-114x114.png?v=807" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://siddroid.com//favicon/apple-touch-icon-72x72.png?v=831" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://siddroid.com//favicon/apple-touch-icon-144x144.png?v=823" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://siddroid.com//favicon/apple-touch-icon-60x60.png?v=673" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://siddroid.com//favicon/apple-touch-icon-120x120.png?v=116" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://siddroid.com//favicon/apple-touch-icon-76x76.png?v=528" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://siddroid.com//favicon/apple-touch-icon-152x152.png?v=150" />
        <link rel="icon" type="image/png" href="https://siddroid.com//favicon/favicon-196x196.png?v=919" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://siddroid.com//favicon/favicon-96x96.png?v=341" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://siddroid.com//favicon/favicon-32x32.png?v=8" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://siddroid.com//favicon/favicon-16x16.png?v=100" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://siddroid.com//favicon/favicon-128.png?v=684" sizes="128x128" />
        <meta name="application-name" content="Siddroid"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://siddroid.com//favicon/mstile-144x144.png?v=185" />
        <meta name="msapplication-square70x70logo" content="https://siddroid.com//favicon/mstile-70x70.png?v=586" />
        <meta name="msapplication-square150x150logo" content="https://siddroid.com//favicon/mstile-150x150.png?v=358" />
        <meta name="msapplication-wide310x150logo" content="https://siddroid.com//favicon/mstile-310x150.png?v=618" />
        <meta name="msapplication-square310x310logo" content="https://siddroid.com//favicon/mstile-310x310.png?v=840" />

  
  </head>
<body class="mainPageBg">
  <div class="topBar" style="display: flex;justify-content: space-between;">

  <div style="margin-left: 1.5rem;">

    <a href="/" style="color: #fff;text-decoration:none;-webkit-tap-highlight-color: transparent;">

    <div style="display:flex; justify-content: center;">

      <div class="author-image topbar-logo" style="margin-right: 10px;width:29px;height:29px;margin-top: 0rem;margin-bottom:12px;clip-path: circle(50% at 50% 50%);">
          <img src="/images/siddhesh_patil.jpg" class="img-headshot center" width="29px" height="29px"
            title="Sid Patil"
            alt="Siddroid - your place to learn Kotlin and Android">
      </div>

      <div>
          <p class="headerTxt" style="font-size: 20px;color: var(--color-topbar-text2);margin-bottom: 0.5em;max-lines: 1;">
            <span id="siteTitleText" style="max-lines: 1;">Sid Patil</span><span id="siteTitleText"></span>   
          </p> 
          

      </div>

          
      
      
    </div>
  </a>

  </div>

  

  


    

    <div style="display:flex;justify-content: center;margin-right: rem;margin-top: 0.2rem;">

          
            
          

    
    <a href="/browse/" title="Navigate this site" style="color:var(--color-topbar-text2);font-family:sansfont;text-decoration: none;-webkit-tap-highlight-color: transparent;">
      <div style="width: 50px;margin-left: 0.3rem;margin-right: 0.3rem;">
          <div style="display: flex;align-items: center;justify-content: center;">
            
            <span class="material-icons-outlined"  style="color: var(--color-topbar-text2);">
              code
            </span>
        </div>
    </div>
    </a>

    
    
    
    
    
    

    
    
    
    
    <a href="/search/" title="Search android articles on Siddroid" style="color:   var(--color-topbar-text2);font-family:sansfont;text-decoration: none;-webkit-tap-highlight-color: transparent;
      ">

<div style="width: 50px;margin-left: 0.3rem;margin-right: 0.3rem;">
    <div style="display: flex;align-items: center;justify-content: center;">
      
      
    </div>
      <div style="display: flex;align-items: center;justify-content: center;">
                  
        <span class="material-icons-outlined"  style="color: var(--color-topbar-text2);">
          search
        </span>

        
    </div>
</div>
    </a>
    
    
    <div id="theme-btn" style="width: 50px;margin-left: 0.3rem;margin-right: 0.3rem;" onclick="toggleTheme()">
      <div style="display: flex;align-items: center;justify-content: center;">
        <span id="theme-icon" class="material-icons-outlined"  style="color: var(--color-topbar-text2);">
          dark_mode
        </span>
    </div>
  </div>
    <a href="/about/" title="Some stuff about Siddhesh" style="color:   var(--color-topbar-text2);font-family:sansfont;text-decoration: none;-webkit-tap-highlight-color: transparent;
      ">
    <div style="width: 50px;margin-left: 0.3rem;margin-right: 0.3rem;">
        <div style="display: flex;align-items: center;justify-content: center;">
          
          
            
        </div>
          <div style="display: flex;align-items: center;justify-content: center;">
            <span class="material-icons-outlined"  style="color: var(--color-topbar-text2);">
              person_outline
            </span>
            
        </div>
    </div>
    </a>
    
  </div>

  

</div>

  <script src="https://siddroid.com/js/theme.js"></script>

  <main id="main-container" style="padding-top: 0.1rem;">
      <div id="main-page-ct" class="parentContainer" style="min-height: 100vh;">
            <div class="post">
 
  <div>
    <h1 class="postTitleHeading">
      Build function chains using composition in Kotlin
    </h1>
  </div>

  

  

  

  
  <div style="margin-top: 1rem;margin-bottom: 1rem;">
    <div>
      <p style="color: var(--color-text-l2);white-space: nowrap;display: inline-block;"><time datetime=" 2021-08-24T12:06:12&#43;0530">Aug 24, 2021</time>&nbsp;<span style="color: var(--color-text-l1);"> · </span>&nbsp;15 min read
        
        
      
        
        
          
            
            <p style="color: var(--color-text-l2);margin-bottom: 0.5rem;white-space: nowrap;display: inline-block;"> &nbsp; <span style="color: var(--color-text-l1);"> · </span> &nbsp;4,566 views</p>
            
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
        
      
        
      
      </p>
    </div>
  </div>


  


  <div>
    
  </div>

  
  

  <meta name="thumbnail" content="https://siddroid.com/images/function-chain-using-composition-in-kotlin-sid-patil.jpeg">
<meta name="twitter:image" content="https://siddroid.com/images/function-chain-using-composition-in-kotlin-sid-patil.jpeg">
<meta name="twitter:card" content="summary_large_image">
<a href="https://androidweekly.net/issues/issue-481" target="blank">
<img alt="Badge" height="20px" src="https://androidweekly.net/issues/issue-481/badge">
</a>
<hr>
<div style="display: flex;align-items: center;justify-content: center;">
    <img style="border-radius: 2rem;" src="/images/composition.gif" alt="Leverage Kotlin fold and reduce functions to build function chains with compositional patterns. We will deep dive into the compose modifier system and build our own function chain pattern with pure Kotlin">
</div>


<p>We are going to focus on how we can use functions to alter the nature of an object and change it, and how we can chain functions together to apply their effects on an object in one go with a composite pattern.</p>
<p><strong>By the end of this article, we would cover:</strong></p>
<ul>
<li>What is function chaining?</li>
<li>Understand how Jetpack Compose Modifiers work</li>
<li>Learn aggregation using fold functions</li>
<li>Build our version of Compose() builder with function chaining</li>
</ul>
<hr>
<h2 id="table-of-content">Table of content</h2>
<ul>
<li><a href="#table-of-content">Table of content</a></li>
<li><a href="#function-chaining">Function chaining</a></li>
<li><a href="#what-is-aggregation">What is aggregation?</a>
<ul>
<li><a href="#folding">Folding</a></li>
</ul>
</li>
<li><a href="#essentials-of-compose-ui-modifiers">Essentials of Compose UI modifiers</a>
<ul>
<li><a href="#i-modifier-interface">I. Modifier Interface</a></li>
<li><a href="#ii-modifier-element">II. Modifier Element</a></li>
<li><a href="#iii-modifier-companion">III. Modifier Companion</a></li>
<li><a href="#iv-combined-modifier">IV. Combined Modifier</a></li>
</ul>
</li>
<li><a href="#visualizing-compose-modifier-function-chain">Visualizing compose modifier function chain</a></li>
<li><a href="#visualizing-view-nesting-based-on-fold-direction">Visualizing view nesting based on fold direction</a></li>
<li><a href="#building-our-function-chaining-with-composition">Building our function chaining with Composition</a>
<ul>
<li><a href="#i-car-example">I. Car Example</a></li>
<li><a href="#ii-building-the-chain-pattern">II. Building the chain pattern</a></li>
<li><a href="#iii-components-of-the-chain">III. Components of the Chain</a></li>
<li><a href="#iv-linkedchain">IV. LinkedChain</a></li>
</ul>
</li>
<li><a href="#building-an-object-with-our-compose-function">Building an object with our Compose() function</a></li>
<li><a href="#extending-and-using-the-chain">Extending and using the Chain</a></li>
<li><a href="#the-result">The result</a></li>
<li><a href="#summary">Summary</a></li>
</ul>
<hr>
<h2 id="function-chaining">Function chaining</h2>
<p>I&rsquo;m sure with the recent stable release of <a href="https://developer.android.com/jetpack/compose">Jetpack Compose</a>, you are familiar with its <strong>Modifier</strong> system. The modifier system by class design allows us to set &ldquo;modifications&rdquo; on the class by chaining functions.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="c1">// f(x) -&gt; g(x) -&gt; h(x) 
</span><span class="c1"></span><span class="n">Modifier</span><span class="p">.</span><span class="n">width</span><span class="p">(</span><span class="m">10.</span><span class="n">dp</span><span class="p">).</span><span class="n">height</span><span class="p">(</span><span class="m">10.</span><span class="n">dp</span><span class="p">).</span><span class="n">padding</span><span class="p">(</span><span class="n">start</span> <span class="p">=</span> <span class="m">8.</span><span class="n">dp</span><span class="p">).</span><span class="n">background</span><span class="p">(</span><span class="n">color</span> <span class="p">=</span> <span class="n">Color</span><span class="p">(</span><span class="m">0xFFFFF0C4</span><span class="p">))</span></code></pre></div>
<p>Notice how each function can be called directly after the invocation of the other, once <strong>.width()</strong> is called immediately you can call <strong>.height()</strong> and in this manner, endlessly chain the functions one after the other till the desired modifications are applied or composed together. Super convenient!</p>
<p>How can we build a pattern similar to this?</p>
<p>Let&rsquo;s take an example of a <strong>Car</strong> class. It has two properties, <strong>ownerName</strong> and <strong>color</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">class</span> <span class="nc">Car</span><span class="p">(</span><span class="k">var</span> <span class="py">ownerName</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="k">var</span> <span class="py">color</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">changeOwner</span><span class="p">(</span><span class="n">newName</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">ownerName</span> <span class="p">=</span> <span class="n">newName</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">repaint</span><span class="p">(</span><span class="n">newColor</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">color</span> <span class="p">=</span> <span class="n">newColor</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>If we create an instance of this class and try to access the functions, we can&rsquo;t chain them successively.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin">    <span class="k">var</span> <span class="py">myCar</span><span class="p">:</span> <span class="n">Car</span> <span class="p">=</span> <span class="n">Car</span><span class="p">(</span><span class="s2">&#34;Sid&#34;</span><span class="p">,</span><span class="s2">&#34;Red&#34;</span><span class="p">)</span>

    <span class="c1">// Standard way of calling functions one after another
</span><span class="c1"></span>    <span class="n">myCar</span><span class="p">.</span><span class="n">changeOwner</span><span class="p">(</span><span class="s2">&#34;New Owner&#34;</span><span class="p">)</span>
    <span class="n">myCar</span><span class="p">.</span><span class="n">repaint</span><span class="p">(</span><span class="s2">&#34;Blue&#34;</span><span class="p">)</span>

    <span class="c1">// Not possible, none of the functions can be chained together
</span><span class="c1"></span>    <span class="n">myCar</span><span class="p">.</span><span class="n">changeOwner</span><span class="p">(</span><span class="s2">&#34;Sid Patil&#34;</span><span class="p">).</span><span class="n">repaint</span><span class="p">(</span><span class="s2">&#34;Green&#34;</span><span class="p">)</span></code></pre></div>
<p>The first thing we all would probably think about is just returning the instance of the same class and chaining will be possible. But this means changing all functions to return an instance of the same class with the return type specifier.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin">    <span class="c1">// Now both functions return the instance of the class and have return type specifiers
</span><span class="c1"></span>
    <span class="k">fun</span> <span class="nf">changeOwner</span><span class="p">(</span><span class="n">newName</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">Car</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">ownerName</span> <span class="p">=</span> <span class="n">newName</span>
        <span class="k">return</span> <span class="k">this</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">repaint</span><span class="p">(</span><span class="n">newColor</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">Car</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">color</span> <span class="p">=</span> <span class="n">newColor</span>
        <span class="k">return</span> <span class="k">this</span>
    <span class="p">}</span></code></pre></div>
<p>The above works but does not support multiple types and is not intuitive. The compose modifier system has separate typed modifiers eg <strong>PaddingModifier</strong>, <strong>FillModifier</strong>, etc and they combine to form linkages between modifiers and generate views.</p>
<p>At this point let me highlight that the compose <strong>Modifier</strong> system leverages Kotlin&rsquo;s extension function capabilities. For example, take fillMaxWidth()</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">fun</span> <span class="nf">Modifier</span><span class="p">.</span><span class="n">fillMaxWidth</span><span class="p">(</span><span class="n">fraction</span><span class="p">:</span> <span class="n">Float</span> <span class="p">=</span> <span class="m">1f</span><span class="p">)</span> <span class="p">:</span> <span class="n">Modifier</span></code></pre></div>
<p>Here the function is extending the <strong>Modifier</strong> object. The function also returns a <strong>Modifier</strong> instance so that consecutive function calls can be chained together.</p>
<p>Wait.. but how is this any different than us simply returning class instances to enable function chaining?</p>
<p>Firstly it supports multiple types of classes (Since modifier is an interface), different implementations of Modifiers can be returned and the chain would still work. Secondly, the modifier system uses an aggregation logic to enable chaining.</p>
<h2 id="what-is-aggregation">What is aggregation?</h2>
<blockquote>
<p>Aggregation: a cluster of things that have come or been brought together</p>
</blockquote>
<p>In our context, aggregation applies to the act of collectively applying operations together. This means applying our functions in a chain to the instance of the object and altering its nature. Kotlin contains powerful in-built aggregating functions.</p>
<h3 id="folding">Folding</h3>
<p>Kotlin&rsquo;s <strong>fold()</strong> function allows us to aggregate operations and collects the result once all operations are performed. Here in our example, we sum all numbers from 1 to 5 using fold.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin">    <span class="c1">// starts folding with initial value 0
</span><span class="c1"></span>    <span class="c1">// aggregates operation from left to right 
</span><span class="c1"></span>
    <span class="k">val</span> <span class="py">numbers</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">)</span>
    <span class="n">numbers</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">{</span> <span class="n">total</span><span class="p">,</span> <span class="n">number</span> <span class="o">-&gt;</span> <span class="n">total</span> <span class="p">+</span> <span class="n">number</span><span class="p">}</span></code></pre></div>
<p>There is <strong>reduce()</strong> function as well, which we can also use if we don&rsquo;t want an initial value before aggregation. Folding is always done in a given direction, left to right or right to left.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin">    <span class="k">val</span> <span class="py">numbers</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">)</span>

    <span class="c1">// 1 + 2 -&gt; 3 + 3 -&gt; 6 + 4 -&gt; 10 + 5 = 15
</span><span class="c1"></span>    <span class="n">numbers</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">{</span> <span class="n">total</span><span class="p">,</span> <span class="n">number</span> <span class="o">-&gt;</span> <span class="n">total</span> <span class="p">+</span> <span class="n">number</span><span class="p">}</span>

    <span class="c1">// 5 + 4 -&gt; 9 + 3 -&gt; 12 + 2 -&gt; 14 + 1 = 15
</span><span class="c1"></span>    <span class="n">numbers</span><span class="p">.</span><span class="n">foldRight</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">{</span><span class="n">total</span><span class="p">,</span> <span class="n">number</span> <span class="o">-&gt;</span> <span class="n">total</span> <span class="p">+</span> <span class="n">number</span><span class="p">}</span></code></pre></div>
<p>The direction of the fold will determine the final result so it&rsquo;s super important that we decide on a direction. In our example the operation was the same i.e. summation, if the operation were to be complex and dependent on the previous operations then your fold direction will determine your final result.</p>
<p>This is precisely why the sequence or order of your function calls on <strong>Modifier</strong> is important in deciding how <strong>Compose</strong> will render your UI.</p>
<p>Now that we&rsquo;ve understood how aggregation works, let&rsquo;s look in detail at how compose modifiers work.</p>
<h2 id="essentials-of-compose-ui-modifiers">Essentials of Compose UI modifiers</h2>
<p>There are four essential components in compose modifiers</p>
<ul>
<li>Modifier Interface</li>
<li>Modifier Element</li>
<li>Modifier Companion</li>
<li>Combined Modifier</li>
</ul>
<p>An understanding of these four building blocks of <strong>Compose UI</strong> will allow us to gain insight into how we can build a simpler version of the same pattern.</p>
<h3 id="i-modifier-interface">I. Modifier Interface</h3>
<p>The modifier interface is the starting unit of the modifier logic. Being an interface it outlines the various operations that can be performed by its implementing classes.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">interface</span> <span class="nc">Modifier</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">foldIn</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span>

    <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">foldOut</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">Element</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span>

    <span class="k">fun</span> <span class="nf">any</span><span class="p">(</span><span class="n">predicate</span><span class="p">:</span> <span class="p">(</span><span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Boolean</span><span class="p">):</span> <span class="n">Boolean</span>

    <span class="k">fun</span> <span class="nf">all</span><span class="p">(</span><span class="n">predicate</span><span class="p">:</span> <span class="p">(</span><span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Boolean</span><span class="p">):</span> <span class="n">Boolean</span>

    <span class="k">infix</span> <span class="k">fun</span> <span class="nf">then</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Modifier</span><span class="p">):</span> <span class="n">Modifier</span> <span class="p">=</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">other</span> <span class="o">===</span> <span class="n">Modifier</span><span class="p">)</span> <span class="k">this</span> <span class="k">else</span> <span class="n">CombinedModifier</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

<span class="p">}</span></code></pre></div>
<p>The <strong>foldIn()</strong> function is essentially a <strong>fold()</strong> function moving from the left to right direction as we understood in the aggregation section. The <strong>foldOut()</strong> is opposite and moves from right to left applying its operations in the chain.</p>
<p>The <strong>then()</strong> function is what allows us to chain our operations, taking in a <strong>Modifier</strong> and returning a <strong>CombinedModifier</strong>. The first referential equality check just asserts that you don&rsquo;t end up chaining your object and in case you do, returns the instance of the self.</p>
<p>The other two functions, <strong>any()</strong> and <strong>all()</strong> are used while materializing for the runtime. Materialize function is an extension of <strong>Composer</strong> which will prepare the modifiers for attaching to the runtime tree-node or for tooling in <strong>Android Studio</strong> through the layout inspector.</p>
<h3 id="ii-modifier-element">II. Modifier Element</h3>
<p>The modifier element is a node within the modifier chain, think of this as a linkage. Many linkages together form the full chain data structure. The modifier element is also an interface.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin">    <span class="k">interface</span> <span class="nc">Element</span> <span class="p">:</span> <span class="n">Modifier</span> <span class="p">{</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">foldIn</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span> <span class="p">=</span>
            <span class="n">operation</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span> <span class="k">this</span><span class="p">)</span>

        <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">foldOut</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">Element</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span> <span class="p">=</span>
            <span class="n">operation</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">initial</span><span class="p">)</span>

        <span class="k">override</span> <span class="k">fun</span> <span class="nf">any</span><span class="p">(</span><span class="n">predicate</span><span class="p">:</span> <span class="p">(</span><span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Boolean</span><span class="p">):</span> <span class="n">Boolean</span> <span class="p">=</span> <span class="n">predicate</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>

        <span class="k">override</span> <span class="k">fun</span> <span class="nf">all</span><span class="p">(</span><span class="n">predicate</span><span class="p">:</span> <span class="p">(</span><span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Boolean</span><span class="p">):</span> <span class="n">Boolean</span> <span class="p">=</span> <span class="n">predicate</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">}</span></code></pre></div>
<h3 id="iii-modifier-companion">III. Modifier Companion</h3>
<p>The modifier companion is an object primarily responsible for starting the chain, it&rsquo;s a simple companion object that implements the modifier interface.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin">    <span class="k">companion</span> <span class="k">object</span> <span class="p">:</span> <span class="n">Modifier</span> <span class="p">{</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">foldIn</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span> <span class="p">=</span> <span class="n">initial</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">foldOut</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">Element</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span> <span class="p">=</span> <span class="n">initial</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="nf">any</span><span class="p">(</span><span class="n">predicate</span><span class="p">:</span> <span class="p">(</span><span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Boolean</span><span class="p">):</span> <span class="n">Boolean</span> <span class="p">=</span> <span class="k">false</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="nf">all</span><span class="p">(</span><span class="n">predicate</span><span class="p">:</span> <span class="p">(</span><span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Boolean</span><span class="p">):</span> <span class="n">Boolean</span> <span class="p">=</span> <span class="k">true</span>
        <span class="k">override</span> <span class="k">infix</span> <span class="k">fun</span> <span class="nf">then</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Modifier</span><span class="p">):</span> <span class="n">Modifier</span> <span class="p">=</span> <span class="n">other</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">=</span> <span class="s2">&#34;Modifier&#34;</span>
    <span class="p">}</span></code></pre></div>
<p>This companion is what is being called when you start chaining with Modifier.width().height()&hellip;</p>
<h3 id="iv-combined-modifier">IV. Combined Modifier</h3>
<p>The combined modifier forms as a unit of the chain and constitutes an Outer and Inner linkage, connecting <strong>Element</strong> and other <strong>CombinedModifier</strong> instances. This is a separate class, that implements the modifier interface as well.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">class</span> <span class="nc">CombinedModifier</span><span class="p">(</span>
    <span class="k">private</span> <span class="k">val</span> <span class="py">outer</span><span class="p">:</span> <span class="n">Modifier</span><span class="p">,</span>
    <span class="k">private</span> <span class="k">val</span> <span class="py">inner</span><span class="p">:</span> <span class="n">Modifier</span>
<span class="p">)</span> <span class="p">:</span> <span class="n">Modifier</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">foldIn</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Modifier</span><span class="p">.</span><span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span> <span class="p">=</span>
        <span class="k">inner</span><span class="p">.</span><span class="n">foldIn</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">foldIn</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span> <span class="n">operation</span><span class="p">),</span> <span class="n">operation</span><span class="p">)</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">foldOut</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Element</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span> <span class="p">=</span>
        <span class="n">outer</span><span class="p">.</span><span class="n">foldOut</span><span class="p">(</span><span class="k">inner</span><span class="p">.</span><span class="n">foldOut</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span> <span class="n">operation</span><span class="p">),</span> <span class="n">operation</span><span class="p">)</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">any</span><span class="p">(</span><span class="n">predicate</span><span class="p">:</span> <span class="p">(</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Boolean</span><span class="p">):</span> <span class="n">Boolean</span> <span class="p">=</span>
        <span class="n">outer</span><span class="p">.</span><span class="n">any</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span> <span class="o">||</span> <span class="k">inner</span><span class="p">.</span><span class="n">any</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">all</span><span class="p">(</span><span class="n">predicate</span><span class="p">:</span> <span class="p">(</span><span class="n">Modifier</span><span class="p">.</span><span class="n">Element</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Boolean</span><span class="p">):</span> <span class="n">Boolean</span> <span class="p">=</span>
        <span class="n">outer</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">inner</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">equals</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">?):</span> <span class="n">Boolean</span> <span class="p">=</span>
        <span class="n">other</span> <span class="k">is</span> <span class="n">CombinedModifier</span> <span class="o">&amp;&amp;</span> <span class="n">outer</span> <span class="o">==</span> <span class="n">other</span><span class="p">.</span><span class="n">outer</span> <span class="o">&amp;&amp;</span> <span class="k">inner</span> <span class="o">==</span> <span class="n">other</span><span class="p">.</span><span class="k">inner</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">hashCode</span><span class="p">():</span> <span class="n">Int</span> <span class="p">=</span> <span class="n">outer</span><span class="p">.</span><span class="n">hashCode</span><span class="p">()</span> <span class="p">+</span> <span class="m">31</span> <span class="p">*</span> <span class="k">inner</span><span class="p">.</span><span class="n">hashCode</span><span class="p">()</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">=</span> <span class="s2">&#34;[&#34;</span> <span class="p">+</span> <span class="n">foldIn</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="p">{</span> <span class="n">acc</span><span class="p">,</span> <span class="n">element</span> <span class="o">-&gt;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">acc</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">())</span> <span class="n">element</span><span class="p">.</span><span class="n">toString</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&#34;</span><span class="si">$acc</span><span class="s2">, </span><span class="si">$element</span><span class="s2">&#34;</span>
    <span class="p">}</span> <span class="p">+</span> <span class="s2">&#34;]&#34;</span>
<span class="p">}</span></code></pre></div>
<p>Even though we are using the term chain as a data structure for organizing our nodes of modifiers, the right way to look at this is to understand that there is an <strong>outer</strong> chain node that wraps around another chain node. Each node of the chain is essentially a <strong>CombinedModifier</strong> forming linkage.</p>
<h2 id="visualizing-compose-modifier-function-chain">Visualizing compose modifier function chain</h2>
<p>The best way to visualize the chain is keeping in mind the outer and inner object wrappings and the linkages formed due to this wrapping.</p>
<div style="display: flex;align-items: center;justify-content: center;">
    <img style="border-radius: 2rem;" src="/images/functional-chaining-compose-modifier-system.png" alt="Leverage Kotlin fold and reduce functions to build function chains with compositional patterns. We will deep dive into the compose modifier system and build our function chain pattern with pure Kotlin">
</div>


<h2 id="visualizing-view-nesting-based-on-fold-direction">Visualizing view nesting based on fold direction</h2>
<p>Another way to look at the chained modifiers is by visualizing how view modifiers are applied when you compose. The direction of composition is from the outermost view to the innermost view.</p>
<div style="display: flex;align-items: center;justify-content: center;">
    <img style="border-radius: 2rem;" src="/images/chained-function-compose-view-kotlin.png" alt="Leverage Kotlin fold and reduce functions to build function chains with compositional patterns. We will deep dive into the compose modifier system and build our function chain pattern with pure Kotlin">
</div>


<blockquote>
<p>The wrapping of objects within combined objects and linking them together through this wrapping itself while enabling traversing through the links using aggregating fold functions is the simple genius behind compose modifier logic.</p>
</blockquote>
<p>We also saw that there is a <strong>foldOut()</strong> function that can also enable aggregation from the inner object to the outer object in the reverse direction if needed.</p>
<h2 id="building-our-function-chaining-with-composition">Building our function chaining with Composition</h2>
<p>Phew! Now that we have covered some basics of function chaining, specifically regarding <strong>Compose</strong> and its modifiers, let us look into how we can build the same pattern for our projects in a simpler fashion along with compositional design.</p>
<h3 id="i-car-example">I. Car Example</h3>
<ul>
<li>Build a pattern that allows us to &ldquo;Compose&rdquo; objects</li>
<li>The pattern must be extensible and reusable throughout our project</li>
<li>Follow compositional design pattern</li>
</ul>
<p>As an example for demonstration, We&rsquo;ll build a Car class over which several properties will be composed.</p>
<p><strong>Our car will have:</strong></p>
<ol>
<li>Engine</li>
<li>Seats</li>
<li>Wheels</li>
<li>Visuals</li>
<li>Manufacturer</li>
<li>Owner</li>
</ol>
<h3 id="ii-building-the-chain-pattern">II. Building the chain pattern</h3>
<p>Taking inspiration from <strong>Compose</strong>, To build our project-wide chaining logic let&rsquo;s start with a simple Chain interface</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="cm">/**
</span><span class="cm"> * Chain core interface
</span><span class="cm"> */</span>
<span class="k">interface</span> <span class="nc">Chain</span> <span class="p">{</span>

    <span class="cm">/**
</span><span class="cm">     * Fold aggregator
</span><span class="cm">     * Direction: Left -&gt; Right
</span><span class="cm">     * @param initial the inital object 
</span><span class="cm">     * @param operation the operation to perform
</span><span class="cm">     * @return the type-specified object
</span><span class="cm">     */</span>
    <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">fold</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">ChainUnit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span>

    <span class="cm">/**
</span><span class="cm">     * Form LinkedChain object linking two ChainUnits
</span><span class="cm">     * @return [LinkedChain] object
</span><span class="cm">     */</span>
    <span class="k">fun</span> <span class="nf">then</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Chain</span><span class="p">):</span> <span class="n">Chain</span> <span class="p">=</span> <span class="n">LinkedChain</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="cm">/**
</span><span class="cm">     * A chain-unit
</span><span class="cm">     * Building block of our chain
</span><span class="cm">     */</span>
    <span class="k">interface</span> <span class="nc">ChainUnit</span> <span class="p">:</span> <span class="n">Chain</span> <span class="p">{</span>
        <span class="cm">/**
</span><span class="cm">         * Fold aggregator
</span><span class="cm">         * Direction: Left -&gt; Right
</span><span class="cm">         * @param initial the inital object
</span><span class="cm">         * @param operation the operation to perform
</span><span class="cm">         * @return the type-specified object
</span><span class="cm">         */</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">fold</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">ChainUnit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span> <span class="p">=</span>
                <span class="n">operation</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span> <span class="k">this</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="cm">/**
</span><span class="cm">     * Companion builder for starting chains
</span><span class="cm">     */</span>
    <span class="k">companion</span> <span class="k">object</span> <span class="p">:</span> <span class="n">Chain</span> <span class="p">{</span>

        <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">fold</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">ChainUnit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span> <span class="p">=</span> <span class="n">initial</span>

        <span class="k">override</span> <span class="k">fun</span> <span class="nf">then</span><span class="p">(</span><span class="n">next</span><span class="p">:</span> <span class="n">Chain</span><span class="p">):</span> <span class="n">Chain</span> <span class="p">=</span> <span class="n">next</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<h3 id="iii-components-of-the-chain">III. Components of the Chain</h3>
<ul>
<li>Chain interface: Outlines chaining capabilities of folding and linking</li>
<li>Chain Unit: The basic unit of our chain implementing capabilities of Chain interface</li>
<li>Chain Companion: To start the chain</li>
</ul>
<p>Our core interface contains one <strong>fold()</strong> function which moves from left to right and a then function that builds a <strong>LinkedChain</strong>. The <strong>then()</strong> function is what creates a <strong>LinkedChain</strong>. A companion is declared to start the <strong>Chain</strong> with initial implementations.</p>
<h3 id="iv-linkedchain">IV. LinkedChain</h3>
<p>A <strong>LinkedChain</strong> houses the outer and inner objects and enables repeated nested wrapping to form the actual chain.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">class</span> <span class="nc">LinkedChain</span><span class="p">(</span>
        <span class="k">private</span> <span class="k">val</span> <span class="py">outer</span><span class="p">:</span> <span class="n">Chain</span><span class="p">,</span>
        <span class="k">private</span> <span class="k">val</span> <span class="py">inner</span><span class="p">:</span> <span class="n">Chain</span>
<span class="p">)</span> <span class="p">:</span> <span class="n">Chain</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span> <span class="nf">fold</span><span class="p">(</span><span class="n">initial</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">Chain</span><span class="p">.</span><span class="n">ChainUnit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">):</span> <span class="n">R</span> <span class="p">=</span>
            <span class="k">inner</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span> <span class="n">operation</span><span class="p">),</span> <span class="n">operation</span><span class="p">)</span>
<span class="p">}</span></code></pre></div>
<p>We override the <strong>fold()</strong> function of the <strong>Chain</strong> interface and call the <strong>fold()</strong> function on the inner object passing the result of the <strong>fold()</strong> function on the outer object as a param to the inner <strong>fold()</strong> function.</p>
<p><em><strong>(Fold-ception!)</strong></em></p>
<p>Now that our Chain logic is complete let&rsquo;s build our Car. <em><strong>Vroom!</strong></em></p>
<h2 id="building-an-object-with-our-compose-function">Building an object with our Compose() function</h2>
<p>We&rsquo;ll build our car keeping in mind that we want to follow a compositional pattern and ensure that our properties of the car are built in a modular, plug-and-play manner allowing us to easily couple change or decouple them in the future if needed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">interface</span> <span class="nc">Vehicle</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">isSafeForEnvironment</span><span class="p">()</span> <span class="p">:</span> <span class="n">Boolean</span>

    <span class="k">fun</span> <span class="nf">color</span><span class="p">()</span> <span class="p">:</span> <span class="n">String</span>

    <span class="k">fun</span> <span class="nf">seatCapacity</span><span class="p">()</span> <span class="p">:</span> <span class="n">Int</span>

    <span class="k">fun</span> <span class="nf">ownerDetails</span><span class="p">()</span> <span class="p">:</span> <span class="n">String</span>

    <span class="k">fun</span> <span class="nf">wheels</span><span class="p">()</span> <span class="p">:</span> <span class="n">Int</span>

    <span class="k">fun</span> <span class="nf">manufacturer</span><span class="p">()</span> <span class="p">:</span> <span class="n">String</span>
<span class="p">}</span></code></pre></div>
<p>We start by defining the functionality of our <strong>Car</strong>, here a <strong>Vehicle</strong> interface is used which will be implemented by our car class.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">class</span> <span class="nc">Car</span> <span class="k">private</span> <span class="k">constructor</span><span class="p">(</span><span class="n">chainer</span><span class="p">:</span> <span class="n">Chain</span><span class="p">)</span> <span class="p">:</span> <span class="n">Vehicle</span> <span class="p">{</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>

        <span class="k">fun</span> <span class="nf">compose</span><span class="p">(</span><span class="n">chainer</span><span class="p">:</span> <span class="n">Chain</span><span class="p">)</span> <span class="p">:</span> <span class="n">Car</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">chainer</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span><span class="n">Car</span><span class="p">(</span><span class="n">chainer</span><span class="p">))</span> <span class="p">{</span> <span class="n">car</span><span class="p">,</span> <span class="n">chainUnit</span> <span class="o">-&gt;</span>
                <span class="n">car</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">isSafeForEnvironment</span><span class="p">():</span> <span class="n">Boolean</span> <span class="p">{}</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">color</span><span class="p">():</span> <span class="n">String</span> <span class="p">{}</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">seatCapacity</span><span class="p">():</span> <span class="n">Int</span> <span class="p">{}</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">ownerDetails</span><span class="p">():</span> <span class="n">String</span> <span class="p">{}</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">wheels</span><span class="p">():</span> <span class="n">Int</span> <span class="p">{}</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">manufacturer</span><span class="p">():</span> <span class="n">String</span> <span class="p">{}</span>

<span class="p">}</span></code></pre></div>
<p>Our <strong>Car</strong> class implements the <strong>Vehicle</strong> interface, all the functions are not implemented yet (we&rsquo;ll fix that). Notice that</p>
<ul>
<li>The constructor is private. It needs a <strong>Chain</strong> to build itself.</li>
<li>We have a companion object in which we have a <strong>compose()</strong> function, which takes the chain as a param. The <strong>compose()</strong> function calls the <strong>fold()</strong> function to compose our car. For now, it&rsquo;s just an empty function that just returns the Car through its type specifier and the accumulated result of the folding.</li>
</ul>
<p>We want all the functionalities and properties of our <strong>Car</strong> to be modular, we&rsquo;ll start by building four modules for the car; <strong>CarEngine</strong>, <strong>CarSpecs</strong>, <strong>CarOwner</strong>, and <strong>CarVisuals</strong>. Each module we build will implement <strong>ChainUnit</strong> interface for chaining capabilities.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">class</span> <span class="nc">CarEngine</span><span class="p">(</span><span class="k">var</span> <span class="py">engineType</span><span class="p">:</span> <span class="n">EngineType</span><span class="p">)</span> <span class="p">:</span> <span class="n">Chain</span><span class="p">.</span><span class="n">ChainUnit</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">needRecharge</span><span class="p">()</span> <span class="p">:</span> <span class="n">Boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">engineType</span> <span class="o">==</span> <span class="n">EngineType</span><span class="p">.</span><span class="n">ELECTRIC</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">causesPollution</span><span class="p">()</span> <span class="p">:</span> <span class="n">Boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">engineType</span> <span class="o">==</span> <span class="n">EngineType</span><span class="p">.</span><span class="n">DIESEL</span> <span class="o">||</span> <span class="n">engineType</span> <span class="o">==</span> <span class="n">EngineType</span><span class="p">.</span><span class="n">PETROL</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">CarVisuals</span><span class="p">(</span><span class="k">var</span> <span class="py">color</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">Chain</span><span class="p">.</span><span class="n">ChainUnit</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">isColorMetallic</span><span class="p">()</span> <span class="p">:</span> <span class="n">Boolean</span> <span class="p">{</span>
        <span class="c1">// some color determining logic here
</span><span class="c1"></span>        <span class="c1">// dummy response
</span><span class="c1"></span>        <span class="k">return</span> <span class="k">true</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">CarSpecs</span><span class="p">(</span><span class="k">var</span> <span class="py">wheelCount</span> <span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="k">var</span> <span class="py">seats</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="k">var</span> <span class="py">manufacturer</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">Chain</span><span class="p">.</span><span class="n">ChainUnit</span> <span class="p">{</span>
    <span class="c1">// more functions here as needed
</span><span class="c1"></span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">CarOwner</span><span class="p">(</span><span class="k">var</span> <span class="py">name</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="k">var</span> <span class="py">licenceNo</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="k">var</span> <span class="py">address</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">Chain</span><span class="p">.</span><span class="n">ChainUnit</span> <span class="p">{</span>
    <span class="k">fun</span> <span class="nf">isLicenceExpired</span><span class="p">()</span> <span class="p">:</span> <span class="n">Boolean</span> <span class="p">{</span>
        <span class="c1">// Some logic based on licenceNo
</span><span class="c1"></span>        <span class="c1">// dummy response
</span><span class="c1"></span>        <span class="k">return</span> <span class="k">false</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>For demonstration, I&rsquo;ve implemented functions for the <strong>CarEngine</strong> module. The rest of the modules serve as an example for now but can house more logic.</p>
<p>Let&rsquo;s add the modules to our car class and complete our <strong>compose()</strong> function. In the compose function, with each fold, we check if the chain unit is a given module and bind it to our object.</p>
<p>Note that in our example, during fold operations we are just binding modules, more powerful logic can be written per fold depending on <strong>ChainUnit</strong> type that will determine the final properties of our object just from the <strong>compose()</strong> function alone.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">class</span> <span class="nc">Car</span> <span class="k">private</span> <span class="k">constructor</span><span class="p">(</span><span class="n">chainer</span><span class="p">:</span> <span class="n">Chain</span><span class="p">)</span> <span class="p">:</span> <span class="n">Vehicle</span> <span class="p">{</span>

    <span class="k">private</span> <span class="k">var</span> <span class="py">carEngine</span><span class="p">:</span> <span class="n">CarEngine</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>
    <span class="k">private</span> <span class="k">var</span> <span class="py">carOwner</span><span class="p">:</span> <span class="n">CarOwner</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>
    <span class="k">private</span> <span class="k">var</span> <span class="py">carSpecs</span><span class="p">:</span> <span class="n">CarSpecs</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>
    <span class="k">private</span> <span class="k">var</span> <span class="py">carVisuals</span><span class="p">:</span> <span class="n">CarVisuals</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>

        <span class="k">fun</span> <span class="nf">compose</span><span class="p">(</span><span class="n">chainer</span><span class="p">:</span> <span class="n">Chain</span><span class="p">)</span> <span class="p">:</span> <span class="n">Car</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">chainer</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span><span class="n">Car</span><span class="p">(</span><span class="n">chainer</span><span class="p">))</span> <span class="p">{</span> <span class="n">car</span><span class="p">,</span> <span class="n">chainUnit</span> <span class="o">-&gt;</span>
                <span class="k">when</span><span class="p">(</span><span class="n">chainUnit</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">is</span> <span class="n">CarEngine</span> <span class="o">-&gt;</span> <span class="n">car</span><span class="p">.</span><span class="n">carEngine</span> <span class="p">=</span> <span class="n">chainUnit</span>
                    <span class="k">is</span> <span class="n">CarVisuals</span> <span class="o">-&gt;</span> <span class="n">car</span><span class="p">.</span><span class="n">carVisuals</span> <span class="p">=</span> <span class="n">chainUnit</span>
                    <span class="k">is</span> <span class="n">CarSpecs</span> <span class="o">-&gt;</span> <span class="n">car</span><span class="p">.</span><span class="n">carSpecs</span> <span class="p">=</span> <span class="n">chainUnit</span>
                    <span class="k">is</span> <span class="n">CarOwner</span> <span class="o">-&gt;</span> <span class="n">car</span><span class="p">.</span><span class="n">carOwner</span> <span class="p">=</span> <span class="n">chainUnit</span>
                <span class="p">}</span>
                <span class="n">car</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span></code></pre></div>
<p>Our <strong>compose()</strong> function is the only way we can construct the car hence, safe to say that the modules would be present when instantiating a new <strong>Car</strong>. Yes, we can pass an empty <strong>Chain</strong>, which can be handled with a simple conditional check.</p>
<p>The result of the chained operations is the accumulator after folding through all the chain units. The accumulator is the final composed object <strong>(The car)</strong>.</p>
<p>Furthermore, our <strong>Vehicle</strong> interface function implementations can now be completed since we have the necessary modules in our car class.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"> <span class="k">override</span> <span class="k">fun</span> <span class="nf">isSafeForEnvironment</span><span class="p">():</span> <span class="n">Boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">if</span><span class="p">(</span><span class="n">carEngine</span> <span class="o">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="p">!</span><span class="n">carEngine</span><span class="o">!!</span><span class="p">.</span><span class="n">causesPollution</span><span class="p">()</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// default, handle as needed
</span><span class="c1"></span>            <span class="k">false</span>
        <span class="p">}</span>
 <span class="p">}</span></code></pre></div>
<p>In the above snippet, we use the car engine and call the <strong>causesPollution()</strong> function from <strong>CarEngine</strong> module to determine if the car is safe for our environment.</p>
<h2 id="extending-and-using-the-chain">Extending and using the Chain</h2>
<p>To use the chain, we&rsquo;ll use Kotlin&rsquo;s extending functions and leverage the <strong>then()</strong> function to chain our function calls.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin"><span class="k">fun</span> <span class="nf">Chain</span><span class="p">.</span><span class="n">carEngineType</span><span class="p">(</span><span class="n">engineType</span><span class="p">:</span> <span class="n">EngineType</span><span class="p">)</span> <span class="p">:</span> <span class="n">Chain</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">then</span><span class="p">(</span>
        <span class="n">CarEngine</span><span class="p">(</span><span class="n">engineType</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">fun</span> <span class="nf">Chain</span><span class="p">.</span><span class="n">carOwnerDetails</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="n">licenceNo</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">Chain</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">then</span><span class="p">(</span>
        <span class="n">CarOwner</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">licenceNo</span><span class="p">,</span><span class="n">address</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">fun</span> <span class="nf">Chain</span><span class="p">.</span><span class="n">carSpecs</span><span class="p">(</span><span class="n">wheelCount</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="n">seats</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="n">manufacturer</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">Chain</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">then</span><span class="p">(</span>
        <span class="n">CarSpecs</span><span class="p">(</span><span class="n">wheelCount</span><span class="p">,</span><span class="n">seats</span><span class="p">,</span><span class="n">manufacturer</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">fun</span> <span class="nf">Chain</span><span class="p">.</span><span class="n">carVisuals</span><span class="p">(</span><span class="n">color</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">Chain</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">then</span><span class="p">(</span>
        <span class="n">CarVisuals</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
<span class="p">)</span></code></pre></div>
<p>Each extension function calls the linking then function from the <strong>Chain</strong> to build <strong>LinkedChain</strong> objects <strong>composing</strong> our final Car.</p>
<p>These extensions are for <strong>Car</strong> object you can build extensions for multiple objects as well.</p>
<h2 id="the-result">The result</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Kotlin" data-lang="Kotlin">    <span class="c1">// Composing our car
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">car</span> <span class="p">=</span> <span class="n">Car</span><span class="p">.</span><span class="n">compose</span><span class="p">(</span><span class="n">Chain</span><span class="p">.</span><span class="n">carEngineType</span><span class="p">(</span><span class="n">EngineType</span><span class="p">.</span><span class="n">ELECTRIC</span><span class="p">)</span>
            <span class="p">.</span><span class="n">carOwnerDetails</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s2">&#34;Android Dev Community&#34;</span><span class="p">,</span>
                    <span class="n">licenceNo</span> <span class="p">=</span> <span class="s2">&#34;API31&#34;</span><span class="p">,</span>
                    <span class="n">address</span> <span class="p">=</span> <span class="s2">&#34;California&#34;</span>
            <span class="p">).</span><span class="n">carSpecs</span><span class="p">(</span>
                    <span class="n">wheelCount</span> <span class="p">=</span> <span class="m">4</span><span class="p">,</span>
                    <span class="n">seats</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                    <span class="n">manufacturer</span> <span class="p">=</span> <span class="s2">&#34;Tesla&#34;</span>
            <span class="p">).</span><span class="n">carVisuals</span><span class="p">(</span>
                    <span class="n">color</span> <span class="p">=</span> <span class="s2">&#34;Green&#34;</span>
            <span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1">// Use the car
</span><span class="c1"></span>    <span class="n">car</span><span class="p">.</span><span class="n">isSafeForEnvironment</span><span class="p">()</span></code></pre></div>
<p>Our pattern is complete! We&rsquo;ve built a function-chaining compositional pattern that can be used project-wide.</p>
<h2 id="summary">Summary</h2>
<ul>
<li>Reusable chaining logic</li>
<li>Modular composition of objects, easy coupling, and decoupling</li>
<li>Extensible</li>
<li>Compose() companion function can be customized</li>
</ul>
<hr>
<p>Here is a <a href="https://gist.github.com/PatilSiddhesh/a5f415907aca8eb4f971238533bf2cf1">Github Gist</a> for your reference, or a <a href="https://pl.kotl.in/rtg4OCYSx">Kotlin Playground</a> link to run the above code.</p>
<p>If you liked this post, and the chaining pattern, do share it and comment any relevant feedback down below. : )</p>

</div>




<div class="authorCard" style="margin-bottom: 1em;">
  <p style="font-weight: bold;">
    <i class="fas fa-bookmark" style="margin-right: 0.5em;color: #FFD54F;"></i>
    About the author
  </p>

  <img src="/images/siddhesh_patil.jpg" style="width: 3rem;height:3rem;float:left;margin-right:0.5rem;margin-bottom: 0.5rem;clip-path: circle(50% at 50% 50%);shape-outside: circle(50%);
  " alt="Siddhesh Patil is an Android Engineer at DeliveryHero. Building core ordering experiences at Foodpanda and Foodora. He is the organzier of Kotlin Mumbai, a developer community in Mumbai, India. Find talks, articles and latest developments in Android and Kotlin on this website siddroid.com">

  <p style="font-size: 80%;">
      Sid Patil is an Android Engineer and Kotlin Advocate based in Berlin, Germany. He works at Delivery Hero, building ordering experiences for food delivery and Q-commerce brands like Foodpanda and Foodora. 
  </p>
  
  





    <a href="https://twitter.com/Siddroid?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="true">Follow @Siddroid</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

    
    
  

  </div>

  
  

 
  
  
  
  

<style>
#share-buttons {display: inline-block; vertical-align: middle; }
#share-buttons:after {content: ""; display: block; clear: both;}
#share-buttons > div {
position: relative;
text-align: left; 
height: 36px; 
width: 32px; 
float: left; 
text-align: center;
}
#share-buttons > div > svg {height: 16px; fill: var(--color-text-l2); margin-top: 10px;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.facebook:hover > svg {fill: #3B5998;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.mail:hover > svg {fill: rgb(238, 36, 36);}
#share-buttons > div.instagram:hover > svg {fill: #C73B92;}
#share-buttons > div.facebook > svg {height: 18px; margin-top: 9px;}
#share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;}
#share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}
</style>

<span style="color: var(--color-text-l2);font-family: sansfont;">Share on </span><div id="share-buttons">
<div class="facebook" title="Share this on Facebook" onclick="window.open('http://www.facebook.com/share.php?u=https:\/\/siddroid.com\/post\/kotlin\/build-function-chains-using-composition-in-kotlin\/');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div>
<div class="twitter" title="Share this on Twitter" onclick="window.open('https://twitter.com/intent/tweet?&url=https:\/\/siddroid.com\/post\/kotlin\/build-function-chains-using-composition-in-kotlin\/');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
<div class="mail" title="Share this through Email" onclick="window.open('mailto:?&body=https:\/\/siddroid.com\/post\/kotlin\/build-function-chains-using-composition-in-kotlin\/');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div>
</div>
  
  


  

  


    <div id="disqus_thread" style="z-index: 0;"></div>

    <script>
      (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://truestark.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
  
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>
  


  

  <div>
  <hr>
  <h3>
    <i class="fas fa-book" style="margin-right: 0.5em;"></i>
    More articles to read
  </h3>
  
  
  <div style="overflow: auto;white-space: nowrap;">
  
  
  
  <ul style="list-style: none;margin-left: -10px;padding: 0;margin-top: 10px;display: flex;">
    
        <li style="margin: 10px;;margin-bottom: 10px;">
          <a href="https://siddroid.com/post/android/supporting-adaptive-themed-icons-on-android-13/" style="color: #4b4444;text-decoration: none;">
            <div class="card" style="background-color: var(--color-canvas-l2);max-width: 20em;min-height: 7em;">
    
              <div style="padding: 10px;">
    
                <div style="padding-left: 20px;padding-right: 20px;height: 50%;">
                  <h4 style="color: var(--color-text-l2);max-lines: 1;text-overflow: ellipsis;overflow: hidden;max-height: 3em;white-space: nowrap;">Supporting adaptive themed icons on Android 13</h4>
                  <p style="font-size: 80%;color: var(--color-text-l2);">
                    <i class="far fa-calendar" aria-hidden="true" style="margin-right: 0.2em;"></i>
                    <time datetime="2022-05-19T12:50:55&#43;0100">May 19, 2022</time>
                  </p>
        
                  <p style="font-size: 80%;color: var(--color-text-l2);max-height:3em;text-overflow: ellipsis;overflow: hidden;white-space: nowrap;max-lines: 2;">
                    
                    One of the coolest features of Android 13 with Material You and Monet is dynamically themed icons. Let us take a look at how we can migrate our apps to Tiramisu and add support for custom themed icons to match the system wide dynamic theme colors.
                    
                  </p>
              </div>
            </div>
          </a>
        </li> 
        
        <li style="margin: 10px;;margin-bottom: 10px;">
          <a href="https://siddroid.com/post/android/chasing-monet-inside-the-android-framework/" style="color: #4b4444;text-decoration: none;">
            <div class="card" style="background-color: var(--color-canvas-l2);max-width: 20em;min-height: 7em;">
    
              <div style="padding: 10px;">
    
                <div style="padding-left: 20px;padding-right: 20px;height: 50%;">
                  <h4 style="color: var(--color-text-l2);max-lines: 1;text-overflow: ellipsis;overflow: hidden;max-height: 3em;white-space: nowrap;">Chasing Monet inside the Android framework</h4>
                  <p style="font-size: 80%;color: var(--color-text-l2);">
                    <i class="far fa-calendar" aria-hidden="true" style="margin-right: 0.2em;"></i>
                    <time datetime="2022-04-28T00:50:55&#43;0100">Apr 28, 2022</time>
                  </p>
        
                  <p style="font-size: 80%;color: var(--color-text-l2);max-height:3em;text-overflow: ellipsis;overflow: hidden;white-space: nowrap;max-lines: 2;">
                    
                    We deep dive into the internals of the Android framework, covering the System-UI to understand the changes introduced starting from Android 12/12L and above, code-named Monet. We will explore the new system-wide dynamic theming capabilities and take a look at how Monet fuels the Material You design.
                    
                  </p>
              </div>
            </div>
          </a>
        </li> 
        
        <li style="margin: 10px;;margin-bottom: 10px;">
          <a href="https://siddroid.com/post/compose/dynamic-themes-with-compose-and-material-3/" style="color: #4b4444;text-decoration: none;">
            <div class="card" style="background-color: var(--color-canvas-l2);max-width: 20em;min-height: 7em;">
    
              <div style="padding: 10px;">
    
                <div style="padding-left: 20px;padding-right: 20px;height: 50%;">
                  <h4 style="color: var(--color-text-l2);max-lines: 1;text-overflow: ellipsis;overflow: hidden;max-height: 3em;white-space: nowrap;">Dynamic themes with Compose and Material 3</h4>
                  <p style="font-size: 80%;color: var(--color-text-l2);">
                    <i class="far fa-calendar" aria-hidden="true" style="margin-right: 0.2em;"></i>
                    <time datetime="2022-04-28T00:50:55&#43;0100">Apr 28, 2022</time>
                  </p>
        
                  <p style="font-size: 80%;color: var(--color-text-l2);max-height:3em;text-overflow: ellipsis;overflow: hidden;white-space: nowrap;max-lines: 2;">
                    
                    Use wallpaper generated system colors from Android 12 and Material You to repaint your apps to the users taste by using the material design 3 library and Jetpack compose
                    
                  </p>
              </div>
            </div>
          </a>
        </li> 
        
        <li style="margin: 10px;;margin-bottom: 10px;">
          <a href="https://siddroid.com/post/community/event-android-worldwide-january-2022/" style="color: #4b4444;text-decoration: none;">
            <div class="card" style="background-color: var(--color-canvas-l2);max-width: 20em;min-height: 7em;">
    
              <div style="padding: 10px;">
    
                <div style="padding-left: 20px;padding-right: 20px;height: 50%;">
                  <h4 style="color: var(--color-text-l2);max-lines: 1;text-overflow: ellipsis;overflow: hidden;max-height: 3em;white-space: nowrap;">Android Worldwide: January 2022</h4>
                  <p style="font-size: 80%;color: var(--color-text-l2);">
                    <i class="far fa-calendar" aria-hidden="true" style="margin-right: 0.2em;"></i>
                    <time datetime="2022-01-27T00:02:16&#43;0530">Jan 27, 2022</time>
                  </p>
        
                  <p style="font-size: 80%;color: var(--color-text-l2);max-height:3em;text-overflow: ellipsis;overflow: hidden;white-space: nowrap;max-lines: 2;">
                    
                    We kickstart 2022 at Android Worldwide with a two days session on January 25th &amp; 26th. This quarter we cover different topics ranging from managing memory at multiplatform level with Kotlin, maxing out the performance of your SQLite database, implementing FTS for faster database querying and much more!
                    
                  </p>
              </div>
            </div>
          </a>
        </li> 
        
        <li style="margin: 10px;;margin-bottom: 10px;">
          <a href="https://siddroid.com/post/post-i-have-joined-delivery-hero-in-berlin-germany/" style="color: #4b4444;text-decoration: none;">
            <div class="card" style="background-color: var(--color-canvas-l2);max-width: 20em;min-height: 7em;">
    
              <div style="padding: 10px;">
    
                <div style="padding-left: 20px;padding-right: 20px;height: 50%;">
                  <h4 style="color: var(--color-text-l2);max-lines: 1;text-overflow: ellipsis;overflow: hidden;max-height: 3em;white-space: nowrap;">I have joined Delivery Hero!</h4>
                  <p style="font-size: 80%;color: var(--color-text-l2);">
                    <i class="far fa-calendar" aria-hidden="true" style="margin-right: 0.2em;"></i>
                    <time datetime="2021-11-11T13:21:39&#43;0100">Nov 11, 2021</time>
                  </p>
        
                  <p style="font-size: 80%;color: var(--color-text-l2);max-height:3em;text-overflow: ellipsis;overflow: hidden;white-space: nowrap;max-lines: 2;">
                    
                    Super excited to share that I have joined Delivery Hero and relocated to Berlin, Germany. For the next chapter of my career, I will be helping shape ordering experiences of multiple food delivery and Q-commerce apps.
                    
                  </p>
              </div>
            </div>
          </a>
        </li> 
        
        <li style="margin: 10px;;margin-bottom: 10px;">
          <a href="https://siddroid.com/post/kotlin-mumbai-events/post-kotlin-for-backend-engineering-himanshu-singh/" style="color: #4b4444;text-decoration: none;">
            <div class="card" style="background-color: var(--color-canvas-l2);max-width: 20em;min-height: 7em;">
    
              <div style="padding: 10px;">
    
                <div style="padding-left: 20px;padding-right: 20px;height: 50%;">
                  <h4 style="color: var(--color-text-l2);max-lines: 1;text-overflow: ellipsis;overflow: hidden;max-height: 3em;white-space: nowrap;">Kotlin Mumbai: Learn backend engineering with Ktor</h4>
                  <p style="font-size: 80%;color: var(--color-text-l2);">
                    <i class="far fa-calendar" aria-hidden="true" style="margin-right: 0.2em;"></i>
                    <time datetime="2021-08-31T13:11:34&#43;0530">Aug 31, 2021</time>
                  </p>
        
                  <p style="font-size: 80%;color: var(--color-text-l2);max-height:3em;text-overflow: ellipsis;overflow: hidden;white-space: nowrap;max-lines: 2;">
                    
                    Himanshu Singh convinces us why Kotlin is a viable option for backend engineering. Explore popular Kotlin backend frameworks and understand the merits of using Ktor.
                    
                  </p>
              </div>
            </div>
          </a>
        </li> 
        
      </ul>
  </div>  
  
  </div>
  
  


  

</div>







      </div>

  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"
          integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0="
          crossorigin="anonymous"></script>

  
  <script src="https://siddroid.com/js/highlight.pack.js"></script>
  <script>hljs.highlightAll();</script>
  
  <script src="https://unpkg.com/lunr/lunr.js"></script>

  <script src="https://siddroid.com/js/search.js"></script>

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-172413499-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  <script src="https://siddroid.com/js/custom.js"></script> </script>
</body>

<footer>

  <div class="bottomBar">

  
    <section class="social-icons">
      <div style="display: flex;justify-content: center;margin-bottom: 1rem;">
          
          <a href="http://twitter.com/intent/user?screen_name=siddroid" rel="me" title="Twitter" target="_blank" style="color: #c7c7c7;margin-left: 1rem;margin-right: 1rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;color: var(--color-text-experimental);">
              <i class="fab fa-twitter" aria-hidden="true" style="height: 23px;width: 23px;"></i>
          </div>
          </a>
          
          <a href="https://www.linkedin.com/in/patilsid/" rel="me" title="Linkedin" target="_blank" style="color: #c7c7c7;margin-left: 1rem;margin-right: 1rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;color: var(--color-text-experimental);">
              <i class="fab fa-linkedin" aria-hidden="true" style="height: 23px;width: 23px;"></i>
          </div>
          </a>
          
          <a href="https://github.com/patilsiddhesh" rel="me" title="GitHub" target="_blank" style="color: #c7c7c7;margin-left: 1rem;margin-right: 1rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;color: var(--color-text-experimental);">
              <i class="fab fa-github" aria-hidden="true" style="height: 23px;width: 23px;"></i>
          </div>
          </a>
          
          <a href="https://www.reddit.com/user/siddheshpatil/" rel="me" title="Reddit" target="_blank" style="color: #c7c7c7;margin-left: 1rem;margin-right: 1rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;color: var(--color-text-experimental);">
              <i class="fab fa-reddit" aria-hidden="true" style="height: 23px;width: 23px;"></i>
          </div>
          </a>
          

          <a href="/index.xml" rel="me" title="RSS" target="_blank" style="color: #c7c7c7;margin-left: 1rem;margin-right: 1rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;color: var(--color-text-experimental);">
              <span class="material-icons-outlined md-24">
                rss_feed
              </span>
          </div>
          </a>
      </div>
    </section>

    <section>
      <div style="display: flex;justify-content: center;">
          <a href="/" rel="me" title="Android" style="color:  var(--color-accent);margin-left: 0.5rem;margin-right: 0.5rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;">
                <p class="headerTxt" style="font-size:90%; color:  var(--color-accent);">Home</p>                      
            </div>
          </a>
          <a href="/browse/" rel="me" title="browse" style="color:  var(--color-accent);margin-left: 0.5rem;margin-right: 0.5rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;">
                <p class="headerTxt" style="font-size:90%; color:  var(--color-accent);">Archive</p>                      
            </div>
          </a>
          <a href="/browse/android/" rel="me" title="work" style="color:  var(--color-accent);margin-left: 0.5rem;margin-right: 0.5rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;">
                <p class="headerTxt" style="font-size:90%; color:  var(--color-accent);">Android</p>                      
            </div>
          </a>
          <a href="/browse/compose/" rel="me" title="talks" style="color:  var(--color-accent);margin-left: 0.5rem;margin-right: 0.5rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;">
                <p class="headerTxt" style="font-size:90%; color:  var(--color-accent); ">Compose</p>                      
            </div>
          </a>
          <a href="/about/" rel="me" title="About" style="color:  var(--color-accent);margin-left: 0.5rem;margin-right: 0.5rem;">
            
            <div style="display: flex;align-items: center;justify-content: center;">
                <p class="headerTxt" style="font-size:90%; color:  var(--color-accent);">About</p>                      
            </div>
          </a>
      </div>
    </section>

  

  <p class="footerDescText" style="font-size: 80%;text-align: center;">Read the latest articles on Android, Kotlin and open-source projects. Find tech talks, news from communities, developer events, and workshops by Android developers around the world.</p>

  <div class="copyright" style="color: var(--color-accent);">
    <p class="headerTxt" style="color: var(--color-accent);">
      Sid Patil 2022 · <a href="/policy/">Content & Privacy Policy</a>
    </p>
  </div>

  </div>      

</footer>




</html>
